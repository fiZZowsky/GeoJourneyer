@page "/profile"
@inject AuthState AuthState
@inject NavigationManager Navigation

<h1>Profile</h1>
@if (!AuthState.IsLoggedIn)
    @if (!_initialized)
    {
        <p>Loading...</p>
    }
    else if (!AuthState.IsLoggedIn)
{
    <p>You are not logged in.</p>
}
else
{
    <p>Welcome, @AuthState.Username!</p>
}

@code {
    private bool _initialized;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender && OperatingSystem.IsBrowser())
        {
            _initialized = true;
            if (!AuthState.IsLoggedIn)
            {
                Navigation.NavigateTo("/login", true);
            }
            else
            {
                StateHasChanged();
            }
        }
    }
}